window.onload=function(){String.prototype.capitalize=function(){return this[0].toUpperCase()+this.slice(1)};const o=Math.pow(8,2),e="ABCDEFGH",t=document.querySelector("#chess"),l=t.getContext("2d");t.width=900,t.height=900;let c={},i=[],r=[],a="black";l.beginPath(),l.rect(0,0,900,900),l.fillStyle="#f0cc9c",l.fill(),l.beginPath(),l.strokeStyle="#604740",l.strokeRect(50,50,800,800),l.strokeRect(40,40,820,820);let n=0,f=8;for(let t=0;t<o;t++){let o=t%8,r=e[o];"A"===r&&(n++,f--);let a=100*o+50,v=100*f+50,h=(a+v)%200?"#f0cc9c":"#604740",d=n;c[r+d]={x:a,y:v,color:h,active:!1};let g=1===d||2===d?"white":"black",s="";8===d||1===d?"A"===r||"H"===r?s="rook":"B"===r||"G"===r?s="knight":"C"===r||"F"===r?s="bishop":"D"===r?s="queen":"E"===r&&(s="king"):2!==d&&7!==d||(s="pawn"),s&&i.push({name:s,img:`${s+g.capitalize()}.png`,selected:`${s+g.capitalize()}Aura.png`,active:!1,box:r+d,color:g,dead:!1}),l.beginPath(),l.font="30px Comic Sans MS",l.fillStyle="#604740",l.textAlign="center",l.fillText(r,a+50,30),l.fillText(r,a+50,890),l.fillText(d,20,v+50),l.fillText(d,880,v+50)}function v(o,e){if(o)if("queen"===o.name)alert(`Les ${r.color} ont gagnÃ© !`),location.reload();else{let e=i.indexOf(o);i[e].box="",i[e].dead=!0,document.querySelector(`#${o.color}Dead`).innerHTML+=`<img src='${"chessPiece/"+o.img}' alt='${o.name}'>`}let t=i.indexOf(r);i[t].box=e,r=!1,a="white"===a?"black":"white",h(i[t])}function h(o){if(r=!1,a!==o.color){let t,l,a,n,f=o.box,v=f[0],h=e.indexOf(v),g=Number(f[1]);if(i[i.indexOf(o)].active=!0,"pawn"===o.name)a=h,l=g-1,"white"===o.color&&(l=g+1),l>0&&l<9&&(t=e[a]+l,n=d(t),n||(c[t].active=!0)),h>0&&(a=h-1,t=e[a]+l,n=d(t),n&&n.color!==o.color&&(c[t].active=!0)),h<7&&(a=h+1,t=e[a]+l,n=d(t),n&&n.color!==o.color&&(c[t].active=!0));else if("rook"===o.name){for(let e=g+1;e<=8&&(t=v+e,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e++);for(let e=g-1;e>0&&(t=v+e,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e--);for(let l=h+1;l<e.length&&(t=e[l]+g,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l++);for(let l=h-1;l>=0&&(t=e[l]+g,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l--);}else if("knight"===o.name)g<7&&(l=g+2,h<7&&(a=h+1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0)),h>0&&(a=h-1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0))),g>2&&(l=g-2,h<7&&(a=h+1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0)),h>0&&(a=h-1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0))),h<6&&(a=h+2,g<8&&(l=g+1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0)),g>1&&(l=g-1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0))),h>1&&(a=h-2,g<8&&(l=g+1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0)),g>1&&(l=g-1,t=e[a]+l,n=d(t),n&&n.color===o.color||(c[t].active=!0)));else if("bishop"===o.name){let i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=g+v,a=h+v,l<9&&a<8&&!r&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l<9&&a>-1&&!i&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=g-v,a=h+v,l>0&&a<8&&!r&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l>0&&a>-1&&!i&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}}else if("queen"===o.name){let i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=g+v,a=h+v,l<9&&a<8&&!r&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l<9&&a>-1&&!i&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}i=!1,r=!1;for(let f=0;f<8;f++){let v=1+f;l=g-v,a=h+v,l>0&&a<8&&!r&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(r=!0)),a=h-v,l>0&&a>-1&&!i&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0),n&&(i=!0))}for(let e=g+1;e<=8&&(t=v+e,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e++);for(let e=g-1;e>0&&(t=v+e,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);e--);for(let l=h+1;l<e.length&&(t=e[l]+g,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l++);for(let l=h-1;l>=0&&(t=e[l]+g,n=d(t),!n||n.color!==o.color)&&(c[t].active=!0,!n);l--);}else"king"===o.name&&(l=g+1,a=h+1,l<9&&a<8&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),a=h-1,l<9&&a>-1&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),l=g-1,a=h+1,l>0&&a<8&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),a=h-1,l>0&&a>-1&&(t=e[a]+l,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),g<8&&(t=v+(g+1),n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),g>1&&(t=v+(g-1),n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),h<7&&(t=e[h+1]+g,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)),h>0&&(t=e[h-1]+g,n=d(t),(!n||n&&n.color!==o.color)&&(c[t].active=!0)));r=o}}function d(o){let e=!1;for(let t in i){let l=i[t];l.box!==o||l.dead||(e=l)}return e}function g(){for(let o in c){let e=c[o];x(e.x,e.y,e.color),e.active&&x(e.x,e.y,"rgba(117,160,255,0.41)")}}function s(){for(let o in c)c[o].active=!1;for(let o in i)i[o].active=!1}function x(o,e,t){l.beginPath(),l.rect(o,e,100,100),l.fillStyle=t,l.fill()}function u(){for(let o of i)if(!o.dead){let e=c[o.box];m("chessPiece/"+o[o.active?"selected":"img"],e.x,e.y,o.imgWidth,o.imgHeight)}}function m(o,e,t){let c=new Image(40,70);c.src=o,c.onload=()=>{l.beginPath(),l.drawImage(c,e+(100-c.width)/2,t+(100-c.height)/2)}}g(),u(),t.addEventListener("click",(function(o){let e=t.getBoundingClientRect();!function(o){for(let e in c){let t=c[e];if(t.x<=o.x&&t.x+100>o.x&&t.y<=o.y&&t.y+100>o.y){let o=d(e);t.active&&v(o,e),s(),o&&"object"==typeof o&&o.hasOwnProperty("dead")&&!o.dead&&h(o)}}}({x:Math.floor(o.clientX-e.left),y:Math.floor(o.clientY-e.top)}),l.beginPath(),l.rect(50,50,800,800),l.fill(),g(),u()}))};
//# sourceMappingURL=script.min.js.map